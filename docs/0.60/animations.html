<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>动画 · React Native 中文网</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="##### 本文档贡献者：[sunnylqm](https://github.com/search?q=sunnylqm%40qq.com+in%3Aemail&amp;type=Users)(100.00%)"/><meta name="docsearch:version" content="0.60"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="动画 · React Native 中文网"/><meta property="og:type" content="website"/><meta property="og:url" content="undefined/"/><meta property="og:description" content="##### 本文档贡献者：[sunnylqm](https://github.com/search?q=sunnylqm%40qq.com+in%3Aemail&amp;type=Users)(100.00%)"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/easyself/react-native-website@1.0.0/img/favicon.ico"/><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/solarized-dark.min.css"/><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/focus-visible@5.0.2/dist/focus-visible.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/easyself/react-native-website@1.0.0/js/codeblocks.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/easyself/react-native-website@1.0.0/js/tabs.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/easyself/react-native-website@1.0.0/js/doccode0325.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/easyself/react-native-website@1.0.0/js/snack.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="https://cdn.jsdelivr.net/gh/easyself/react-native-website@1.0.0/js/scrollSpy.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/easyself/react-native-website@1.0.0/css/main.css"/><script src="https://cdn.jsdelivr.net/gh/easyself/react-native-website@1.0.0/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="https://cdn.jsdelivr.net/gh/easyself/react-native-website@1.0.0/img/header_logo.svg" alt="React Native 中文网"/><h2 class="headerTitleWithLogo">React Native 中文网</h2></a><a href="/versions"><h3>0.60</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/0.60/getting-started" target="_self">文档</a></li><li class=""><a href="/docs/0.60/activityindicator" target="_self">API</a></li><li class=""><a href="//github.com/easyself/react-native-website/issues" target="_blank">讨论</a></li><li class=""><a href="/about" target="_self">关于</a></li><li class=""><a target="_self"></a></li><li class=""><a href="https://github.com/facebook/react-native" target="_self">GitHub</a></li><li class=""><a href="//zh-hans.reactjs.org/" target="_blank">React</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>进阶指南</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">入门基础<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/0.60/getting-started">搭建开发环境</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/tutorial">示例教程：Hello World</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/props">Props（属性）</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/state">State（状态）</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/style">样式</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/height-and-width">高度与宽度</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/flexbox">使用Flexbox布局</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/handling-text-input">处理文本输入</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/handling-touches">处理触摸事件</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/using-a-scrollview">使用滚动视图</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/using-a-listview">使用长列表</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/network">网络</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/sample-application-movies">示例教程：电影列表</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/more-resources">其他参考资源</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">进阶指南<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/0.60/components-and-apis">组件和API</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/platform-specific-code">特定平台代码</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/navigation">使用导航器跳转页面</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/images">图片</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/0.60/animations">动画</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/accessibility">无障碍功能</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/improvingux">改进用户体验</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/timers">定时器</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/debugging">调试</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/performance">性能</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/gesture-responder-system">手势响应系统</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/javascript-environment">JavaScript环境</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/direct-manipulation">直接操作</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/colors">颜色</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/integration-with-existing-apps">集成到现有原生应用</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/building-for-apple-tv">为电视和机顶盒制作应用</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/running-on-device">在设备上运行</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/upgrading">更新</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/native-modules-setup">原生模块配置</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/out-of-tree-platforms">多平台支持</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/building-from-source">从源代码编译React Native</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/publishing-forks">发布自己定制的ReactNative包</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/testing">Testing your Changes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">使用指南(iOS)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/0.60/native-modules-ios">原生模块</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/native-components-ios">原生UI组件</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/linking-libraries-ios">链接原生库</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/running-on-simulator-ios">在iOS模拟器上运行</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/communication-ios">和原生端通信</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/app-extensions">iOS应用扩展</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">使用指南(Android)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/0.60/native-modules-android">原生模块</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/native-components-android">原生UI组件</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/headless-js-android">Headless JS（后台任务）</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/signed-apk-android">打包APK</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/removing-default-permissions">移除不需要的权限</a></li><li class="navListItem"><a class="navItem" href="/docs/0.60/hermes">Using Hermes</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="//www.github.com/easyself/react-native-website/blob/production/cndocs/animations.md" target="_blank" rel="noreferrer noopener">帮助改进此文档</a><h1 id="__docusaurus" class="postHeaderTitle">动画</h1></header><article><div><span><h5><a class="anchor" aria-hidden="true" id="本文档贡献者：sunnylqmhttpsgithubcomsearchqsunnylqm40qqcomin3aemailtypeusers10000"></a><a href="#本文档贡献者：sunnylqmhttpsgithubcomsearchqsunnylqm40qqcomin3aemailtypeusers10000" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>本文档贡献者：<a href="https://github.com/search?q=sunnylqm%40qq.com+in%3Aemail&amp;type=Users">sunnylqm</a>(100.00%)</h5>
<p>流畅、有意义的动画对于移动应用用户体验来说是非常重要的。现实生活中的物体在开始移动和停下来的时候都具有一定的惯性，我们在界面中也可以使用动画来实现契合物理规律的交互。</p>
<p>React Native 提供了两个互补的动画系统：用于创建精细的交互控制的动画<a href="/docs/0.60/animations#animated-api"><code>Animated</code></a>和用于全局的布局动画<a href="/docs/0.60/animations#layoutanimation-api"><code>LayoutAnimation</code></a>。</p>
<h2><a class="anchor" aria-hidden="true" id="animated"></a><a href="#animated" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>Animated</code></h2>
<p><a href="/docs/0.60/animated"><code>Animated</code></a>使得开发者可以非常容易地实现各种各样的动画和交互方式，并且具备极高的性能。<code>Animated</code>旨在以声明的形式来定义动画的输入与输出，在其中建立一个可配置的变化函数，然后使用简单的<code>start/stop</code>方法来控制动画按顺序执行。
<code>Animated</code>仅封装了6个可以动画化的组件：<code>View</code>、<code>Text</code>、<code>Image</code>、<code>ScrollView</code>、<code>FlatList</code>和<code>SectionList</code>，不过你也可以使用<code>Animated.createAnimatedComponent()</code>来封装你自己的组件。下面是一个在加载时带有淡入动画效果的视图：</p>
<div class="snack-player"><div class="mobile-friendly-snack" style="display: none"><pre><code class="hljs css javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { Animated, Text, View } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FadeInView</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  state = {
    <span class="hljs-attr">fadeAnim</span>: <span class="hljs-keyword">new</span> Animated.Value(<span class="hljs-number">0</span>),  <span class="hljs-comment">// 透明度初始值设为0</span>
  }

  componentDidMount() {
    Animated.timing(                  <span class="hljs-comment">// 随时间变化而执行动画</span>
      <span class="hljs-keyword">this</span>.state.fadeAnim,            <span class="hljs-comment">// 动画中的变量值</span>
      {
        <span class="hljs-attr">toValue</span>: <span class="hljs-number">1</span>,                   <span class="hljs-comment">// 透明度最终变为1，即完全不透明</span>
        <span class="hljs-attr">duration</span>: <span class="hljs-number">10000</span>,              <span class="hljs-comment">// 让动画持续一段时间</span>
      }
    ).start();                        <span class="hljs-comment">// 开始执行动画</span>
  }

  render() {
    <span class="hljs-keyword">let</span> { fadeAnim } = <span class="hljs-keyword">this</span>.state;

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Animated.View</span>                 // 使用专门的可动画化的<span class="hljs-attr">View</span>组件
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">...this.props.style</span>,
          <span class="hljs-attr">opacity:</span> <span class="hljs-attr">fadeAnim</span>,         // 将透明度指定为动画变量值
        }}
      &gt;</span>
        {this.props.children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Animated.View</span>&gt;</span></span>
    );
  }
}

<span class="hljs-comment">// 然后你就可以在组件中像使用`View`那样去使用`FadeInView`了</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{flex:</span> <span class="hljs-attr">1</span>, <span class="hljs-attr">alignItems:</span> '<span class="hljs-attr">center</span>', <span class="hljs-attr">justifyContent:</span> '<span class="hljs-attr">center</span>'}}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FadeInView</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{width:</span> <span class="hljs-attr">250</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">50</span>, <span class="hljs-attr">backgroundColor:</span> '<span class="hljs-attr">powderblue</span>'}}&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{fontSize:</span> <span class="hljs-attr">28</span>, <span class="hljs-attr">textAlign:</span> '<span class="hljs-attr">center</span>', <span class="hljs-attr">margin:</span> <span class="hljs-attr">10</span>}}&gt;</span>Fading in<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">FadeInView</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    )
  }
}
</code></pre></div><div class="desktop-friendly-snack" style="margin-top: 15px; margin-bottom: 15px"><div
        data-snack-name="Example"
        data-snack-description="Example usage"
        data-snack-code="import%20React%20from%20'react'%3B%0Aimport%20%7B%20Animated%2C%20Text%2C%20View%20%7D%20from%20'react-native'%3B%0A%0Aclass%20FadeInView%20extends%20React.Component%20%7B%0A%20%20state%20%3D%20%7B%0A%20%20%20%20fadeAnim%3A%20new%20Animated.Value(0)%2C%20%20%2F%2F%20%E9%80%8F%E6%98%8E%E5%BA%A6%E5%88%9D%E5%A7%8B%E5%80%BC%E8%AE%BE%E4%B8%BA0%0A%20%20%7D%0A%0A%20%20componentDidMount()%20%7B%0A%20%20%20%20Animated.timing(%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E9%9A%8F%E6%97%B6%E9%97%B4%E5%8F%98%E5%8C%96%E8%80%8C%E6%89%A7%E8%A1%8C%E5%8A%A8%E7%94%BB%0A%20%20%20%20%20%20this.state.fadeAnim%2C%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%8A%A8%E7%94%BB%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F%E5%80%BC%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20toValue%3A%201%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E9%80%8F%E6%98%8E%E5%BA%A6%E6%9C%80%E7%BB%88%E5%8F%98%E4%B8%BA1%EF%BC%8C%E5%8D%B3%E5%AE%8C%E5%85%A8%E4%B8%8D%E9%80%8F%E6%98%8E%0A%20%20%20%20%20%20%20%20duration%3A%2010000%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E8%AE%A9%E5%8A%A8%E7%94%BB%E6%8C%81%E7%BB%AD%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%0A%20%20%20%20%20%20%7D%0A%20%20%20%20).start()%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%E5%8A%A8%E7%94%BB%0A%20%20%7D%0A%0A%20%20render()%20%7B%0A%20%20%20%20let%20%7B%20fadeAnim%20%7D%20%3D%20this.state%3B%0A%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%3CAnimated.View%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E4%BD%BF%E7%94%A8%E4%B8%93%E9%97%A8%E7%9A%84%E5%8F%AF%E5%8A%A8%E7%94%BB%E5%8C%96%E7%9A%84View%E7%BB%84%E4%BB%B6%0A%20%20%20%20%20%20%20%20style%3D%7B%7B%0A%20%20%20%20%20%20%20%20%20%20...this.props.style%2C%0A%20%20%20%20%20%20%20%20%20%20opacity%3A%20fadeAnim%2C%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%B0%86%E9%80%8F%E6%98%8E%E5%BA%A6%E6%8C%87%E5%AE%9A%E4%B8%BA%E5%8A%A8%E7%94%BB%E5%8F%98%E9%87%8F%E5%80%BC%0A%20%20%20%20%20%20%20%20%7D%7D%0A%20%20%20%20%20%20%3E%0A%20%20%20%20%20%20%20%20%7Bthis.props.children%7D%0A%20%20%20%20%20%20%3C%2FAnimated.View%3E%0A%20%20%20%20)%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20%E7%84%B6%E5%90%8E%E4%BD%A0%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%9C%A8%E7%BB%84%E4%BB%B6%E4%B8%AD%E5%83%8F%E4%BD%BF%E7%94%A8%60View%60%E9%82%A3%E6%A0%B7%E5%8E%BB%E4%BD%BF%E7%94%A8%60FadeInView%60%E4%BA%86%0Aexport%20default%20class%20App%20extends%20React.Component%20%7B%0A%20%20render()%20%7B%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%3CView%20style%3D%7B%7Bflex%3A%201%2C%20alignItems%3A%20'center'%2C%20justifyContent%3A%20'center'%7D%7D%3E%0A%20%20%20%20%20%20%20%20%3CFadeInView%20style%3D%7B%7Bwidth%3A%20250%2C%20height%3A%2050%2C%20backgroundColor%3A%20'powderblue'%7D%7D%3E%0A%20%20%20%20%20%20%20%20%20%20%3CText%20style%3D%7B%7BfontSize%3A%2028%2C%20textAlign%3A%20'center'%2C%20margin%3A%2010%7D%7D%3EFading%20in%3C%2FText%3E%0A%20%20%20%20%20%20%20%20%3C%2FFadeInView%3E%0A%20%20%20%20%20%20%3C%2FView%3E%0A%20%20%20%20)%0A%20%20%7D%0A%7D%0A"
        data-snack-platform="web"
        data-snack-preview="true"
        style="
          overflow: hidden;
          background: #fafafa;
          border: 1px solid rgba(0,0,0,.16);
          border-radius: 4px;
          height: 514px;
          width: 100%;
        "
      ></div></div></div><p>我们来分解一下这个过程。在<code>FadeInView</code>的构造函数里，我们创建了一个名为<code>fadeAnim</code>的<code>Animated.Value</code>，并放在<code>state</code>中。而<code>View</code>的透明度是和这个值绑定的。</p>
<p>组件加载时，透明度首先设为 0。然后一个easing动画开始改变<code>fadeAnim</code>值，同时会导致所有与其相关联的值（本例中是透明度）也逐帧更新，最终和<code>fadeAnim</code>一样变为1。</p>
<p>这一过程经过特别优化，执行效率会远高于反复调用<code>setState</code>和多次重渲染。</p>
<p>因为这一过程是纯声明式的，因此还有进一步优化的空间，比如我们可以把这些声明的配置序列化后发送到一个高优先级的线程上运行。</p>
<h3><a class="anchor" aria-hidden="true" id="配置动画"></a><a href="#配置动画" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>配置动画</h3>
<p>动画拥有非常灵活的配置项。自定义的或预定义的 easing 函数、延迟、持续时间、衰减系数、弹性常数等都可以在对应类型的动画中进行配置。</p>
<p><code>Animated</code>提供了多种动画类型，其中最常用的要属<a href="/docs/0.60/animated#timing"><code>Animated.timing()</code></a>. It supports animating a value over time using one of various predefined easing functions, or you can use your own. Easing functions are typically used in animation to convey gradual acceleration and deceleration of objects.</p>
<p>By default, <code>timing</code> will use a easeInOut curve that conveys gradual acceleration to full speed and concludes by gradually decelerating to a stop. You can specify a different easing function by passing a <code>easing</code> parameter. Custom <code>duration</code> or even a <code>delay</code> before the animation starts is also supported.</p>
<p>For example, if we want to create a 2-second long animation of an object that slightly backs up before moving to its final position:</p>
<pre><code class="hljs css language-jsx">Animated.timing(<span class="hljs-keyword">this</span>.state.xPosition, {
  <span class="hljs-attr">toValue</span>: <span class="hljs-number">100</span>,
  <span class="hljs-attr">easing</span>: Easing.back(),
  <span class="hljs-attr">duration</span>: <span class="hljs-number">2000</span>
}).start();
</code></pre>
<p>Take a look at the <a href="/docs/0.60/animated#配置动画">配置动画</a> section of the <code>Animated</code> API reference to learn more about all the config parameters supported by the built-in animations.</p>
<h3><a class="anchor" aria-hidden="true" id="组合动画"></a><a href="#组合动画" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组合动画</h3>
<p>多个动画可以通过<code>parallel</code>（同时执行）、<code>sequence</code>（顺序执行）、<code>stagger</code>和<code>delay</code>来组合使用。它们中的每一个都接受一个要执行的动画数组，并且自动在适当的时候调用<code>start/stop</code>。</p>
<p>For example, the following animation coasts to a stop, then it springs back while twirling in parallel:</p>
<pre><code class="hljs css language-jsx">Animated.sequence([
  <span class="hljs-comment">// decay, then spring to start and twirl</span>
  Animated.decay(position, {
    <span class="hljs-comment">// coast to a stop</span>
    <span class="hljs-attr">velocity</span>: { <span class="hljs-attr">x</span>: gestureState.vx, <span class="hljs-attr">y</span>: gestureState.vy }, <span class="hljs-comment">// velocity from gesture release</span>
    <span class="hljs-attr">deceleration</span>: <span class="hljs-number">0.997</span>
  }),
  Animated.parallel([
    <span class="hljs-comment">// after decay, in parallel:</span>
    Animated.spring(position, {
      <span class="hljs-attr">toValue</span>: { <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> } <span class="hljs-comment">// return to start</span>
    }),
    Animated.timing(twirl, {
      <span class="hljs-comment">// and twirl</span>
      <span class="hljs-attr">toValue</span>: <span class="hljs-number">360</span>
    })
  ])
]).start(); <span class="hljs-comment">// start the sequence group</span>
</code></pre>
<p>默认情况下，如果任何一个动画被停止或中断了，组内所有其它的动画也会被停止。Parallel 有一个<code>stopTogether</code>属性，如果设置为<code>false</code>，可以禁用自动停止。</p>
<p>在<code>Animated</code>文档的<a href="/docs/0.60/animated#composing-animations">组合动画</a>一节中列出了所有的组合方法。</p>
<h3><a class="anchor" aria-hidden="true" id="合成动画值"></a><a href="#合成动画值" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>合成动画值</h3>
<p>你可以使用加减乘除以及取余等运算来<a href="/docs/0.60/animated#combining-animated-values">把两个动画值合成为一个新的动画值</a>。</p>
<p>There are some cases where an animated value needs to invert another animated value for calculation. An example is inverting a scale (2x --&gt; 0.5x):</p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> Animated.Value(<span class="hljs-number">1</span>);
<span class="hljs-keyword">const</span> b = Animated.divide(<span class="hljs-number">1</span>, a);

Animated.spring(a, {
  <span class="hljs-attr">toValue</span>: <span class="hljs-number">2</span>
}).start();
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="插值"></a><a href="#插值" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>插值</h3>
<p>Each property can be run through an interpolation first. An interpolation maps input ranges to output ranges, typically using a linear interpolation but also supports easing functions. By default, it will extrapolate the curve beyond the ranges given, but you can also have it clamp the output value.</p>
<p>A simple mapping to convert a 0-1 range to a 0-100 range would be:</p>
<pre><code class="hljs css language-jsx">value.interpolate({
  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
  <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">100</span>]
});
</code></pre>
<p>For example, you may want to think about your <code>Animated.Value</code> as going from 0 to 1, but animate the position from 150px to 0px and the opacity from 0 to 1. This can easily be done by modifying <code>style</code> from the example above like so:</p>
<pre><code class="hljs css language-jsx">  style={{
    <span class="hljs-attr">opacity</span>: <span class="hljs-keyword">this</span>.state.fadeAnim, <span class="hljs-comment">// Binds directly</span>
    <span class="hljs-attr">transform</span>: [{
      <span class="hljs-attr">translateY</span>: <span class="hljs-keyword">this</span>.state.fadeAnim.interpolate({
        <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
        <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">150</span>, <span class="hljs-number">0</span>]  <span class="hljs-comment">// 0 : 150, 0.5 : 75, 1 : 0</span>
      }),
    }],
  }}
</code></pre>
<p><a href="/docs/0.60/animated#interpolate"><code>interpolate()</code></a>还支持定义多个区间段落，常用来定义静止区间等。举个例子，要让输入在接近-300 时取相反值，然后在输入接近-100 时到达 0，然后在输入接近 0 时又回到 1，接着一直到输入到 100 的过程中逐步回到 0，最后形成一个始终为 0 的静止区间，对于任何大于 100 的输入都返回 0。具体写法如下：</p>
<pre><code class="hljs css language-jsx">value.interpolate({
  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">-300</span>, <span class="hljs-number">-100</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">101</span>],
  <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">300</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
});
</code></pre>
<p>它的最终映射结果如下：</p>
<pre><code class="hljs">|<span class="hljs-string"> 输入 </span>|<span class="hljs-string"> 输出 </span>|
|<span class="hljs-string"> ---- </span>|<span class="hljs-string"> ---- </span>|
|<span class="hljs-string"> -400 </span>|<span class="hljs-string"> 450  </span>|
|<span class="hljs-string"> -300 </span>|<span class="hljs-string"> 300  </span>|
|<span class="hljs-string"> -200 </span>|<span class="hljs-string"> 150  </span>|
|<span class="hljs-string"> -100 </span>|<span class="hljs-string"> 0    </span>|
|<span class="hljs-string"> -50  </span>|<span class="hljs-string"> 0.5  </span>|
|<span class="hljs-string"> 0    </span>|<span class="hljs-string"> 1    </span>|
|<span class="hljs-string"> 50   </span>|<span class="hljs-string"> 0.5  </span>|
|<span class="hljs-string"> 100  </span>|<span class="hljs-string"> 0    </span>|
|<span class="hljs-string"> 101  </span>|<span class="hljs-string"> 0    </span>|
|<span class="hljs-string"> 200  </span>|<span class="hljs-string"> 0    </span>|
</code></pre>
<p><code>interpolate()</code>还支持到字符串的映射，从而可以实现颜色以及带有单位的值的动画变换。例如你可以像下面这样实现一个旋转动画：</p>
<pre><code class="hljs css language-jsx">value.interpolate({
  <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">360</span>],
  <span class="hljs-attr">outputRange</span>: [<span class="hljs-string">"0deg"</span>, <span class="hljs-string">"360deg"</span>]
});
</code></pre>
<p><code>interpolate()</code>还支持任意的渐变函数，其中有很多已经在<a href="/docs/0.60/easing"><code>Easing</code></a>类中定义了，包括二次、指数、贝塞尔等曲线以及 step、bounce 等方法。<code>interpolation</code>还支持限制输出区间<code>outputRange</code>。你可以通过设置<code>extrapolate</code>、<code>extrapolateLeft</code>或<code>extrapolateRight</code>属性来限制输出区间。默认值是<code>extend</code>（允许超出），不过你可以使用<code>clamp</code>选项来阻止输出值超过<code>outputRange</code>。</p>
<h3><a class="anchor" aria-hidden="true" id="跟踪动态值"></a><a href="#跟踪动态值" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>跟踪动态值</h3>
<p>动画中所设的值还可以通过跟踪别的值得到。你只要把 toValue 设置成另一个动态值而不是一个普通数字就行了。比如我们可以用弹跳动画来实现聊天头像的闪动，又比如通过<code>timing</code>设置<code>duration:0</code>来实现快速的跟随。他们还可以使用插值来进行组合：</p>
<pre><code class="hljs css language-jsx">Animated.spring(follower, { <span class="hljs-attr">toValue</span>: leader }).start();
Animated.timing(opacity, {
  <span class="hljs-attr">toValue</span>: pan.x.interpolate({
    <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">300</span>],
    <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  })
}).start();
</code></pre>
<p>The <code>leader</code> and <code>follower</code> animated values would be implemented using <code>Animated.ValueXY()</code>. 是一个方便的处理 2D 交互的办法，譬如旋转或拖拽。它是一个简单的包含了两个<code>Animated.Value</code>实例的包装，然后提供了一系列辅助函数，使得<code>ValueXY</code>在许多时候可以替代<code>Value</code>来使用。比如在上面的代码片段中，<code>leader</code>和<code>follower</code>可以同时为<code>valueXY</code>类型，这样 x 和 y 的值都会被跟踪。</p>
<h3><a class="anchor" aria-hidden="true" id="跟踪手势"></a><a href="#跟踪手势" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>跟踪手势</h3>
<p><a href="/docs/0.60/animated#event"><code>Animated.event</code></a>是 Animated 中与输入有关的部分，允许手势或其它事件直接绑定到动态值上。它通过一个结构化的映射语法来完成，使得复杂事件对象中的值可以被正确的解开。第一层是一个数组，允许同时映射多个值，然后数组的每一个元素是一个嵌套的对象。在下面的例子里，你可以发现<code>scrollX</code>被映射到了<code>event.nativeEvent.contentOffset.x</code>(<code>event</code>通常是回调函数的第一个参数)，并且<code>pan.x</code>和<code>pan.y</code>分别映射到<code>gestureState.dx</code>和<code>gestureState.dy</code>（<code>gestureState</code>是传递给<code>PanResponder</code>回调函数的第二个参数）。</p>
<p>For example, when working with horizontal scrolling gestures, you would do the following in order to map <code>event.nativeEvent.contentOffset.x</code> to <code>scrollX</code> (an <code>Animated.Value</code>):</p>
<pre><code class="hljs css language-jsx"> onScroll={Animated.event(
   <span class="hljs-comment">// scrollX = e.nativeEvent.contentOffset.x</span>
   [{ <span class="hljs-attr">nativeEvent</span>: {
        <span class="hljs-attr">contentOffset</span>: {
          <span class="hljs-attr">x</span>: scrollX
        }
      }
    }]
 )}
</code></pre>
<p>When using <code>PanResponder</code>, you could use the following code to extract the x and y positions from <code>gestureState.dx</code> and <code>gestureState.dy</code>. We use a <code>null</code> in the first position of the array, as we are only interested in the second argument passed to the <code>PanResponder</code> handler, which is the <code>gestureState</code>.</p>
<pre><code class="hljs css language-jsx">onPanResponderMove={Animated.event(
  [<span class="hljs-literal">null</span>, <span class="hljs-comment">// ignore the native event</span>
  <span class="hljs-comment">// extract dx and dy from gestureState</span>
  <span class="hljs-comment">// like 'pan.x = gestureState.dx, pan.y = gestureState.dy'</span>
  {<span class="hljs-attr">dx</span>: pan.x, <span class="hljs-attr">dy</span>: pan.y}
])}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="响应当前的动画值"></a><a href="#响应当前的动画值" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>响应当前的动画值</h3>
<p>你可能会注意到这里没有一个明显的方法来在动画的过程中读取当前的值——这是出于优化的角度考虑，有些值只有在原生代码运行阶段中才知道。如果你需要在 JavaScript 中响应当前的值，有两种可能的办法：</p>
<ul>
<li><code>spring.stopAnimation(callback)</code>会停止动画并且把最终的值作为参数传递给回调函数<code>callback</code>——这在处理手势动画的时候非常有用。</li>
<li><code>spring.addListener(callback)</code>会在动画的执行过程中持续异步调用<code>callback</code>回调函数，提供一个最近的值作为参数。这在用于触发状态切换的时候非常有用，譬如当用户拖拽一个东西靠近的时候弹出一个新的气泡选项。不过这个状态切换可能并不会十分灵敏，因为它不像许多连续手势操作（如旋转）那样在 60fps 下运行。</li>
</ul>
<p><code>Animated</code> is designed to be fully serializable so that animations can be run in a high performance way, independent of the normal JavaScript event loop. This does influence the API, so keep that in mind when it seems a little trickier to do something compared to a fully synchronous system. Check out <code>Animated.Value.addListener</code> as a way to work around some of these limitations, but use it sparingly since it might have performance implications in the future.</p>
<h3><a class="anchor" aria-hidden="true" id="启用原生动画驱动"></a><a href="#启用原生动画驱动" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>启用原生动画驱动</h3>
<p><code>Animated</code>的 API 是可序列化的（即可转化为字符串表达以便通信或存储）。通过启用<a href="http://facebook.github.io/react-native/blog/2017/02/14/using-native-driver-for-animated.html">原生驱动</a>，我们在启动动画前就把其所有配置信息都发送到原生端，利用原生代码在 UI 线程执行动画，而不用每一帧都在两端间来回沟通。如此一来，动画一开始就完全脱离了 JS 线程，因此此时即便 JS 线程被卡住，也不会影响到动画了。</p>
<p>在动画中启用原生驱动非常简单。只需在开始动画之前，在动画配置中加入一行<code>useNativeDriver: true</code>，如下所示：</p>
<pre><code class="hljs css language-jsx">Animated.timing(<span class="hljs-keyword">this</span>.state.animatedValue, {
  <span class="hljs-attr">toValue</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">duration</span>: <span class="hljs-number">500</span>,
  <span class="hljs-attr">useNativeDriver</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// &lt;-- 加上这一行</span>
}).start();
</code></pre>
<p>动画值在不同的驱动方式之间是不能兼容的。因此如果你在某个动画中启用了原生驱动，那么所有和此动画依赖相同动画值的其他动画也必须启用原生驱动。</p>
<p>原生驱动还可以在<code>Animated.event</code>中使用。 This is specially useful for animations that follow the scroll position as without the native driver, the animation will always run a frame behind the gesture due to the async nature of React Native.</p>
<pre><code class="hljs css language-jsx">&lt;Animated.ScrollView // &lt;-- 使用可动画化的ScrollView组件
  scrollEventThrottle={1} // &lt;-- 设为1以确保滚动事件的触发频率足够密集
  onScroll={Animated.event(
    [
      {
        nativeEvent: {
          contentOffset: { y: this.state.animatedValue }
        }
      }
    ],
    { useNativeDriver: true } // &lt;-- 加上这一行
  )}
&gt;
  {content}
&lt;/Animated.ScrollView&gt;
</code></pre>
<p>You can see the native driver in action by running the <a href="https://github.com/facebook/react-native/blob/master/RNTester/">RNTester app</a>, then loading the Native Animated Example. You can also take a look at the <a href="https://github.com/facebook/react-native/blob/master/RNTester/js/NativeAnimationsExample.js">source code</a> to learn how these examples were produced.</p>
<h4><a class="anchor" aria-hidden="true" id="注意事项"></a><a href="#注意事项" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>注意事项</h4>
<p>Not everything you can do with <code>Animated</code> is currently supported by the native driver. The main limitation is that you can only animate non-layout properties: things like <code>transform</code> and <code>opacity</code> will work, but flexbox and position properties will not. When using <code>Animated.event</code>, it will only work with direct events and not bubbling events. This means it does not work with <code>PanResponder</code> but does work with things like <code>ScrollView#onScroll</code>.</p>
<p>When an animation is running, it can prevent <code>VirtualizedList</code> components from rendering more rows. If you need to run a long or looping animation while the user is scrolling through a list, you can use <code>isInteraction: false</code> in your animation's config to prevent this issue.</p>
<h3><a class="anchor" aria-hidden="true" id="bear-in-mind"></a><a href="#bear-in-mind" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bear in mind</h3>
<p>While using transform styles such as <code>rotateY</code>, <code>rotateX</code>, and others ensure the transform style <code>perspective</code> is in place. At this time some animations may not render on Android without it. Example below.</p>
<pre><code class="hljs css language-jsx">&lt;Animated.View
  style={{
    <span class="hljs-attr">transform</span>: [
      { <span class="hljs-attr">scale</span>: <span class="hljs-keyword">this</span>.state.scale },
      { <span class="hljs-attr">rotateY</span>: <span class="hljs-keyword">this</span>.state.rotateY },
      { <span class="hljs-attr">perspective</span>: <span class="hljs-number">1000</span> } <span class="hljs-comment">// without this line this Animation will not render on Android while working fine on iOS</span>
    ]
  }}
/&gt;
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="additional-examples"></a><a href="#additional-examples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Additional examples</h3>
<p>The RNTester app has various examples of <code>Animated</code> in use:</p>
<ul>
<li><a href="https://github.com/facebook/react-native/tree/master/RNTester/js/examples/Animated/AnimatedGratuitousApp">AnimatedGratuitousApp</a></li>
<li><a href="https://github.com/facebook/react-native/blob/master/RNTester/js/examples/NativeAnimation/NativeAnimationsExample.js">NativeAnimationsExample</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="layoutanimation-api"></a><a href="#layoutanimation-api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>LayoutAnimation</code> API</h2>
<p><code>LayoutAnimation</code>允许你在全局范围内<code>创建</code>和<code>更新</code>动画，这些动画会在下一次渲染或布局周期运行。它常用来更新 flexbox 布局，因为它可以无需测量或者计算特定属性就能直接产生动画。尤其是当布局变化可能影响到父节点（譬如“查看更多”展开动画既增加父节点的尺寸又会将位于本行之下的所有行向下推动）时，如果不使用<code>LayoutAnimation</code>，可能就需要显式声明组件的坐标，才能使得所有受影响的组件能够同步运行动画。</p>
<p>注意尽管<code>LayoutAnimation</code>非常强大且有用，但它对动画本身的控制没有<code>Animated</code>或者其它动画库那样方便，所以如果你使用<code>LayoutAnimation</code>无法实现一个效果，那可能还是要考虑其他的方案。</p>
<p>另外，如果要在<strong>Android</strong>上使用 LayoutAnimation，那么目前还需要在<code>UIManager</code>中启用：:</p>
<pre><code class="hljs css language-jsx"><span class="hljs-comment">// 在执行任何动画代码之前，比如在入口文件App.js中执行</span>
UIManager.setLayoutAnimationEnabledExperimental &amp;&amp;
  UIManager.setLayoutAnimationEnabledExperimental(<span class="hljs-literal">true</span>);
</code></pre>
<div class="snack-player"><div class="mobile-friendly-snack" style="display: none"><pre><code class="hljs css javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> {
  NativeModules,
  LayoutAnimation,
  Text,
  TouchableOpacity,
  StyleSheet,
  View,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;

<span class="hljs-keyword">const</span> { UIManager } = NativeModules;

UIManager.setLayoutAnimationEnabledExperimental &amp;&amp;
  UIManager.setLayoutAnimationEnabledExperimental(<span class="hljs-literal">true</span>);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  state = {
    <span class="hljs-attr">w</span>: <span class="hljs-number">100</span>,
    <span class="hljs-attr">h</span>: <span class="hljs-number">100</span>,
  };

  _onPress = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Animate the update</span>
    LayoutAnimation.spring();
    <span class="hljs-keyword">this</span>.setState({<span class="hljs-attr">w</span>: <span class="hljs-keyword">this</span>.state.w + <span class="hljs-number">15</span>, <span class="hljs-attr">h</span>: <span class="hljs-keyword">this</span>.state.h + <span class="hljs-number">15</span>})
  }

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{[styles.box,</span> {<span class="hljs-attr">width:</span> <span class="hljs-attr">this.state.w</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">this.state.h</span>}]} /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TouchableOpacity</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{this._onPress}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.button}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.buttonText}</span>&gt;</span>Press me!<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">TouchableOpacity</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    );
  }
}

<span class="hljs-keyword">const</span> styles = StyleSheet.create({
  <span class="hljs-attr">container</span>: {
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">alignItems</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">'center'</span>,
  },
  <span class="hljs-attr">box</span>: {
    <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">200</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'red'</span>,
  },
  <span class="hljs-attr">button</span>: {
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'black'</span>,
    <span class="hljs-attr">paddingHorizontal</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">paddingVertical</span>: <span class="hljs-number">15</span>,
    <span class="hljs-attr">marginTop</span>: <span class="hljs-number">15</span>,
  },
  <span class="hljs-attr">buttonText</span>: {
    <span class="hljs-attr">color</span>: <span class="hljs-string">'#fff'</span>,
    <span class="hljs-attr">fontWeight</span>: <span class="hljs-string">'bold'</span>,
  },
});
</code></pre></div><div class="desktop-friendly-snack" style="margin-top: 15px; margin-bottom: 15px"><div
        data-snack-name="Example"
        data-snack-description="Example usage"
        data-snack-code="import%20React%20from%20'react'%3B%0Aimport%20%7B%0A%20%20NativeModules%2C%0A%20%20LayoutAnimation%2C%0A%20%20Text%2C%0A%20%20TouchableOpacity%2C%0A%20%20StyleSheet%2C%0A%20%20View%2C%0A%7D%20from%20'react-native'%3B%0A%0Aconst%20%7B%20UIManager%20%7D%20%3D%20NativeModules%3B%0A%0AUIManager.setLayoutAnimationEnabledExperimental%20%26%26%0A%20%20UIManager.setLayoutAnimationEnabledExperimental(true)%3B%0A%0Aexport%20default%20class%20App%20extends%20React.Component%20%7B%0A%20%20state%20%3D%20%7B%0A%20%20%20%20w%3A%20100%2C%0A%20%20%20%20h%3A%20100%2C%0A%20%20%7D%3B%0A%0A%20%20_onPress%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20%2F%2F%20Animate%20the%20update%0A%20%20%20%20LayoutAnimation.spring()%3B%0A%20%20%20%20this.setState(%7Bw%3A%20this.state.w%20%2B%2015%2C%20h%3A%20this.state.h%20%2B%2015%7D)%0A%20%20%7D%0A%0A%20%20render()%20%7B%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%3CView%20style%3D%7Bstyles.container%7D%3E%0A%20%20%20%20%20%20%20%20%3CView%20style%3D%7B%5Bstyles.box%2C%20%7Bwidth%3A%20this.state.w%2C%20height%3A%20this.state.h%7D%5D%7D%20%2F%3E%0A%20%20%20%20%20%20%20%20%3CTouchableOpacity%20onPress%3D%7Bthis._onPress%7D%3E%0A%20%20%20%20%20%20%20%20%20%20%3CView%20style%3D%7Bstyles.button%7D%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CText%20style%3D%7Bstyles.buttonText%7D%3EPress%20me!%3C%2FText%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FView%3E%0A%20%20%20%20%20%20%20%20%3C%2FTouchableOpacity%3E%0A%20%20%20%20%20%20%3C%2FView%3E%0A%20%20%20%20)%3B%0A%20%20%7D%0A%7D%0A%0Aconst%20styles%20%3D%20StyleSheet.create(%7B%0A%20%20container%3A%20%7B%0A%20%20%20%20flex%3A%201%2C%0A%20%20%20%20alignItems%3A%20'center'%2C%0A%20%20%20%20justifyContent%3A%20'center'%2C%0A%20%20%7D%2C%0A%20%20box%3A%20%7B%0A%20%20%20%20width%3A%20200%2C%0A%20%20%20%20height%3A%20200%2C%0A%20%20%20%20backgroundColor%3A%20'red'%2C%0A%20%20%7D%2C%0A%20%20button%3A%20%7B%0A%20%20%20%20backgroundColor%3A%20'black'%2C%0A%20%20%20%20paddingHorizontal%3A%2020%2C%0A%20%20%20%20paddingVertical%3A%2015%2C%0A%20%20%20%20marginTop%3A%2015%2C%0A%20%20%7D%2C%0A%20%20buttonText%3A%20%7B%0A%20%20%20%20color%3A%20'%23fff'%2C%0A%20%20%20%20fontWeight%3A%20'bold'%2C%0A%20%20%7D%2C%0A%7D)%3B%0A"
        data-snack-platform="web"
        data-snack-preview="true"
        style="
          overflow: hidden;
          background: #fafafa;
          border: 1px solid rgba(0,0,0,.16);
          border-radius: 4px;
          height: 514px;
          width: 100%;
        "
      ></div></div></div><p>This example uses a preset value, you can customize the animations as you need, see <a href="https://github.com/facebook/react-native/blob/master/Libraries/LayoutAnimation/LayoutAnimation.js">LayoutAnimation.js</a> for more information.</p>
<h2><a class="anchor" aria-hidden="true" id="其他要注意的地方"></a><a href="#其他要注意的地方" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>其他要注意的地方</h2>
<h3><a class="anchor" aria-hidden="true" id="requestanimationframe"></a><a href="#requestanimationframe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>requestAnimationFrame</code></h3>
<p><code>requestAnimationFrame</code>是一个对浏览器标准 API 的兼容实现，你可能已经熟悉它了。它接受一个函数作为唯一的参数，并且在下一次重绘之前调用此函数。一些基于 JavaScript 的动画库高度依赖于这一 API。通常你不必直接调用它——那些动画库会替你管理好帧的更新。</p>
<h3><a class="anchor" aria-hidden="true" id="setnativeprops"></a><a href="#setnativeprops" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>setNativeProps</code></h3>
<p>正如<a href="/docs/0.60/direct-manipulation">直接操作</a>文档所说，<code>setNativeProps</code>方法可以使我们直接修改基于原生视图的组件的属性，而不需要使用<code>setState</code>来重新渲染整个组件树。</p>
<p>如果我们要更新的组件有一个非常深的内嵌结构，并且没有使用<code>shouldComponentUpdate</code>来优化，那么使用<code>setNativeProps</code>就将大有裨益。</p>
<p>如果你发现你的动画丢帧（低于 60 帧每秒），可以尝试使用<code>setNativeProps</code>或者<code>shouldComponentUpdate</code>来优化它们。Or you could run the animations on the UI thread rather than the JavaScript thread <a href="http://facebook.github.io/react-native/blog/2017/02/14/using-native-driver-for-animated.html">with the useNativeDriver option</a>. 你还可以考虑将部分计算工作放在动画完成之后进行，这时可以使用<a href="/docs/0.60/interactionmanager">InteractionManager</a>。你还可以使用应用内的开发者菜单中的“FPS Monitor”工具来监控应用的帧率。</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/0.60/images"><span class="arrow-prev">← </span><span>图片</span></a><a class="docs-next button" href="/docs/0.60/accessibility"><span>无障碍功能</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#animated"><code>Animated</code></a><ul class="toc-headings"><li><a href="#配置动画">配置动画</a></li><li><a href="#组合动画">组合动画</a></li><li><a href="#合成动画值">合成动画值</a></li><li><a href="#插值">插值</a></li><li><a href="#跟踪动态值">跟踪动态值</a></li><li><a href="#跟踪手势">跟踪手势</a></li><li><a href="#响应当前的动画值">响应当前的动画值</a></li><li><a href="#启用原生动画驱动">启用原生动画驱动</a></li><li><a href="#bear-in-mind">Bear in mind</a></li><li><a href="#additional-examples">Additional examples</a></li></ul></li><li><a href="#layoutanimation-api"><code>LayoutAnimation</code> API</a></li><li><a href="#其他要注意的地方">其他要注意的地方</a><ul class="toc-headings"><li><a href="#requestanimationframe"><code>requestAnimationFrame</code></a></li><li><a href="#setnativeprops"><code>setNativeProps</code></a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright"><p style="color:inherit">React Native中文网 © 2020</p></section></footer></div></body></html>